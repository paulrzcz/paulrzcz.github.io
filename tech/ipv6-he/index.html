<!DOCTYPE html>
<html lang="en-us" dir="ltr" prefix="og: http://ogp.me/ns#" id="top-of-site">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,shrink-to-fit=no">

    <link rel="canonical" href="https://paulrz.cz/tech/ipv6-he/">

    <title>Huricane Electric IPv6 tunnel broker - PaulRz</title>
    <meta name="description" content="IPv6 is quite old technology but its adoptions is not as widespread as IPv4. Blessed with virtually unlimited number of addresses, it still lacks support on …">
    <meta name="keywords" content="software, development, architecture, management, , clean">

    <meta name="author" content="PaulRz">
    <meta name="generator" content="Hugo 0.110.0">

    
    <link crossorigin="anonymous" href="/css/stylesheet.min.b72470296d30baad44974c775258db89dc088ade7ebc5ab0817131c8b36ccc48.css" integrity="sha256-tyRwKW0wuq1El0x3UljbidwIit5+vFqwgXExyLNszEg=" rel="preload stylesheet" as="style">

    <link rel="icon" href="/favicon.ico" sizes="32x32">
    <link rel="icon" href="/icon-192.png" sizes="192x192" type="image/png">
    <link rel="icon" href="/icon-512.png" sizes="512x512" type="image/png">
    
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    <link rel="manifest" type="application/manifest+json" href="/manifest.webmanifest" title="Manifest">
    <link rel="sitemap" type="application/xml" href="/sitemap.xml" title="Sitemap">
    <link rel="author" type="text/plain" href="/humans.txt" title="Humans">


    <meta name="theme-color" content="#ffffff">    
    <meta property="og:title" content="Huricane Electric IPv6 tunnel broker - PaulRz">
    <meta property="og:description" content="IPv6 is quite old technology but its adoptions is not as widespread as IPv4. Blessed with virtually unlimited number of addresses, it still lacks support on …">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://paulrz.cz/tech/ipv6-he/">
    <meta property="og:image" content="https://paulrz.cz/img/open-graph-logo.png">
    <meta property="og:image:width" content="200">
    <meta property="og:image:height" content="200">
    <meta property="article:published_time" content="2024-06-01T00:00:00">
    <meta property="article:modified_time" content="2024-06-01T00:00:00">
    
    <meta name="twitter:title" content="Huricane Electric IPv6 tunnel broker - PaulRz">
    <meta name="twitter:description" content="IPv6 is quite old technology but its adoptions is not as widespread as IPv4. Blessed with virtually unlimited number of addresses, it still lacks support on …">
    <meta name="twitter:site" content="@paulrzcz">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://paulrz.cz/img/open-graph-logo.png">
    

<script type="application/ld+json" id="schema-data">
    {
        "@context": "https://schema.org",
        "@type": "Article",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://paulrz.cz/tech/ipv6-he/"
        },
        "url": "https://paulrz.cz/tech/ipv6-he/",
        "headline": "Huricane Electric IPv6 tunnel broker - PaulRz",
        "description": "IPv6 is quite old technology but its adoptions is not as widespread as IPv4. Blessed with virtually unlimited number of addresses, it still lacks support on …",
        "keywords": ["software","development","architecture","management",null,"clean"],
        "datePublished": "2024-06-01T00:00:00Z",
        "dateModified": "2024-06-01T00:00:00Z",
            "author": {
                "@type": "Person",
                "name": "PaulRz"
            },
        "publisher": {
            "@type": "Organization",
            "name": "Pavel Ryžov",
            "logo": {
                "@type": "ImageObject",
                "url": "https://paulrz.cz/img/open-graph-logo_hu649006a96c7f6a02c0a48e2d90a9a7b0_5229_96x96_resize_box_3.png",
                "width": "96",
                "height": "96"
            }
        }
    }
</script>



    <script src="/js/common.js"></script>
</head>

    <body class="theme-base-blue">
        <div id="top-of-site-anchor"></div>
        
            
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<aside class="sidebar" id="sidebar">
    <div class="sidebar-item">
        <p>PaulRz - Pavel Ryžov architect and manager with 20 years of experience</p>
    </div>

    <nav class="sidebar-nav">
            <a class="sidebar-nav-item"
                href="/"
                id="menu-main-home">Home</a>
            <a class="sidebar-nav-item"
                href="/about/"
                id="menu-main-about">About</a>
            <a class="sidebar-nav-item"
                href="/tech/"
                id="menu-main-tech">Tech Notes</a>
            <a class="sidebar-nav-item"
                href="/books/"
                id="menu-main-books">Books' reviews</a>
            <a class="sidebar-nav-item"
                href="/search/"
                id="menu-main-search">Search</a>
            <a class="sidebar-nav-item"
                href="/contact/"
                id="menu-main-contact">Contact</a>
            <a class="sidebar-nav-item"
                href="https://github.com/paulrzcz/"
                id="menu-main-github" target="_blank" rel="noopener noreferrer">GitHub Project</a>
        <span class="hypothesis-container">
    <a class="sidebar-nav-item" id="hypothesis-link" href="#">Annotate me</a>
</span>

            <div class="sidebar-nav-item">
                    
                    <a href="/feeds/feed.rss.xml" id="menu-feeds-rss" class="menu-feeds-item" data-feed-type="rss">RSS 2.0</a>
                
                    <span aria-hidden="true">|</span>
                    <a href="/feeds/feed.atom.xml" id="menu-feeds-atom" class="menu-feeds-item" data-feed-type="atom">Atom</a>
                
                    <span aria-hidden="true">|</span>
                    <a href="/feeds/feed.json" id="menu-feeds-json" class="menu-feeds-item" data-feed-type="json">Json Feed</a>
                
            </div>
        
    </nav>

    
    <div class="sidebar-item">
        <p>Built with <a href="https://github.com/sergeyklay/gohugo-theme-ed" target="_blank" rel="noopener noreferrer">Ed</a>. Distributed under an MIT license.</p>
    </div>


</aside>

        
        <div class="wrap">
            <header class="masthead">
                <div class="container">
                    <h3 class="masthead-title">
                        <a href="/" title="Home">PaulRz</a>
                        <br><small>Building Software That Lasts</small>
                    </h3>
                </div>
            </header>

            <main class="container content" id="main">
                <article class="tech" role="document">
    <header>
        <h1 class="text-title">
            Huricane Electric IPv6 tunnel broker
        </h1>
        <p class="byline">
            
                


Published on
<time datetime="2024-06-01T00:00:00Z">
    June 1, 2024
</time>




            
        </p>
    </header>

    <div class="tech-body">
        <p>IPv6 is quite old technology but its adoptions is not as widespread as IPv4. Blessed with virtually
unlimited number of addresses, it still lacks support on major internet service providers. But one might
use a tunnel to <a href="https://tunnelbroker.net">Hurricane Electric</a> to get a routable prefix to his home network.</p>
<p>Last days I&rsquo;ve been studying OpenBSD 7.5 and use it as a home lab and a home router. So let&rsquo;s start!</p>
<h2 id="configure-tunnel">Configure tunnel</h2>
<p>You provide your public IP to HE and you get the something like this:</p>
<ul>
<li>Server IPv4 address - we will use 216.66.88.98</li>
<li>Server IPv6 address - we will use 2001:db8:1f1c:1a6::1/64</li>
<li>Client IPv4 address - we will use 10.0.2.22 because my machine is behind NAT, otherwise the public IP must be used.</li>
<li>Client IPv6 address - we will use 2001:db8:1f1c:1a6::2/64</li>
<li>Routed /48 - we will use 2001:db8:cafe::/48</li>
</ul>
<p>The prefix 2001:db8::/32 has a special meaning in IPv6 address plan and it&rsquo;s called a documentation prefix.
It is used only for documentation purposes.</p>
<p>So, you need to create a file <code>/etc/hostname.gif0</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">tunnel 10.0.2.22 216.66.88.98
</span></span><span class="line"><span class="cl">inet6 <span class="nb">alias</span> 2001:db8:1f1c:1a6::2 <span class="m">128</span> 2001:db8:1f1c:1a6::1
</span></span><span class="line"><span class="cl">!route -n add -inet6 default 2001:db8:1f1c:1a6::1
</span></span><span class="line"><span class="cl">up
</span></span></code></pre></div><p>This file specifies that the interface <code>gif0</code> is created that:</p>
<ol>
<li>tunnels network traffic from <code>10.0.2.22</code> to <code>216.66.88.98</code>;</li>
<li>uses static IPv6 address <code>2001:db8:1f1c:1a6::2</code> with prefix length <code>128</code> and broadcasting to <code>2001:db8:1f1c:1a6::1</code>;</li>
<li>has default route for IPv6 to broadcasting address <code>2001:db8:1f1c:1a6::2</code>;</li>
<li>and <code>up</code> and running!</li>
</ol>
<p>&ndash; clarify each row</p>
<h2 id="check-the-connectivity">Check the connectivity</h2>
<p>Start the interface by:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># sh /etc/netstart gif0</span>
</span></span></code></pre></div><p>Or you might reboot the machine as files <code>hostname.*</code> specify all network interfaces that should be created during the boot.</p>
<p>Now, you should be able to ping Google by IPv6 network:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ping6 google.com</span>
</span></span></code></pre></div><p>If not, check your colons! In IPv6 addresses, of course.</p>
<h2 id="router-advertisements">Router advertisements</h2>
<p>Router with IPv6 is great but others machines on the network don&rsquo;t bother about it. So, router should let them know. The standard procedure for it uses router advertisements and <code>rad</code> daemon.</p>
<p>The configuration <code>rad.conf</code> is pretty straight forward:</p>
<pre tabindex="0"><code>dns {
    nameserver {
        2001:4860:4860::8888
        2001:4860:4860::8844
    }
}

interface em0 {
    prefix 2001:db8:cafe::/48
}
</code></pre><p>It says use Google DNS servers and advertise the routed prefix on the network interface</p>
<p>If you didn&rsquo;t modify the default packet filter configuration, whole the network should support IPv6 internet.</p>
<p>That&rsquo;s it!</p>
<p>PS: The book <a href="https://www.amazon.com/Absolute-OpenBSD-2nd-Practical-Paranoid-ebook">Absolute OpenBSD by Michael W. Lucas</a> is a fantastic guide to this part of the world.</p>

    </div>

    
    
        

<div class="tags-wrapper">
    <ul class="post-tags">
        
    </ul>
</div>

    
</article>

            </main>
        </div>

        <label for="sidebar-checkbox" class="sidebar-toggle"></label>

        <a href="#top-of-site" class="top-of-site-link" data-visible="false">
            <span class="screen-reader-text" aria-label="Back to top of the page">
                Back to top
            </span>
            <svg width="32" height="32" viewBox="0 0 100 100">
                <path fill="white" d="m50 0c-13.262 0-25.98 5.2695-35.355 14.645s-14.645 22.094-14.645 35.355 5.2695 25.98 14.645 35.355 22.094 14.645 35.355 14.645 25.98-5.2695 35.355-14.645 14.645-22.094 14.645-35.355-5.2695-25.98-14.645-35.355-22.094-14.645-35.355-14.645zm20.832 62.5-20.832-22.457-20.625 22.457c-1.207 0.74219-2.7656 0.57812-3.7891-0.39844-1.0273-0.98047-1.2695-2.5273-0.58594-3.7695l22.918-25c0.60156-0.61328 1.4297-0.96094 2.2891-0.96094 0.86328 0 1.6914 0.34766 2.293 0.96094l22.918 25c0.88672 1.2891 0.6875 3.0352-0.47266 4.0898-1.1562 1.0508-2.9141 1.0859-4.1133 0.078125z"></path>
            </svg>
        </a>
    </body>
</html>
